<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Directory Content</title>
</head>

<body>

    <h1 id="folder-title">GitHub Directory Content</h1>

    <h2 id="breadcrumb"></h2>

    <ul id="directory-list"></ul>

    <script>
        const username = 'omarjuvera';
        const repo = 'Portfolios';

        // Get the current script element
        const scriptElement = document.currentScript;

        // Extract the path of the script file
        const scriptPath = scriptElement.src.split('/').slice(3, -1).join('/'); // Remove the protocol and domain

        // Use the extracted path as the directory path
        const directoryPath = scriptPath;

        const apiUrl = `https://api.github.com/repos/${username}/${repo}/contents/${directoryPath}`;

        fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                const directoryList = document.getElementById('directory-list');
                const folderTitle = document.getElementById('folder-title');
                const breadcrumb = document.getElementById('breadcrumb');

                // Extract the last part of the directory path
                const folderName = directoryPath.split('/').filter(Boolean).pop();

                // Capitalize the first letter and make the rest lowercase
                const formattedFolderName = folderName.charAt(0).toUpperCase() + folderName.slice(1).toLowerCase();

                // Set the formatted folder name as H1 text
                folderTitle.textContent = formattedFolderName;

                // Breadcrumb logic
                const breadcrumbPath = directoryPath.split('/').filter(Boolean);
                breadcrumbPath.unshift('Home'); // Adding "Home" at the beginning

                breadcrumbPath.forEach((path, index) => {
                    // Capitalize the first letter and replace "-" with spaces
                    const formattedPath = path.charAt(0).toUpperCase() + path.slice(1).replace(/-/g, ' ');

                    // Create breadcrumb item
                    const breadcrumbItem = document.createElement('span');
                    breadcrumbItem.textContent = formattedPath;

                    // Add separator (except for the last item)
                    if (index < breadcrumbPath.length - 1) {
                        breadcrumbItem.innerHTML += ' => ';
                    }

                    // Append to breadcrumb
                    breadcrumb.appendChild(breadcrumbItem);
                });

                data.forEach(item => {
                    if (item.type === 'file') {
                        const listItem = document.createElement('li');
                        const link = document.createElement('a');
                        // Construct GitHub Pages URL for files
                        link.href = `https://${username}.github.io/${repo}${directoryPath}/${item.name}`;
                        link.textContent = item.name;
                        listItem.appendChild(link);
                        directoryList.appendChild(listItem);
                    } else if (item.type === 'dir') {
                        const listItem = document.createElement('li');
                        const link = document.createElement('a');
                        // Construct GitHub Pages URL for directories
                        link.href = `https://${username}.github.io/${repo}${directoryPath}/${item.name}/`;
                        link.textContent = item.name + '/';
                        listItem.appendChild(link);
                        directoryList.appendChild(listItem);
                    }
                });
            })
            .catch(error => console.error('Error fetching directory content:', error));
    </script>

</body>

</html>
